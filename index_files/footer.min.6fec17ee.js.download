var $window=$j(window),$document=$j(document),windowHeight=$window.height(),windowWidth=$window.width();function createCookie(e,t,a){var r;if(a){var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3),r="; expires="+n.toGMTString()}else r="";document.cookie=e+"="+t+r+"; path=/"}function readCookie(e){for(var t=e+"=",a=document.cookie.split(";"),r=0;r<a.length;r++){for(var n=a[r];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}function findHeight(e){var t=0;$j(e).each(function(){$this=$j(this),$this.height()>t&&(this,t=$this.height())}),$j(e).height(t)}function success_message(e,t){jQuery(".messages-container").remove();var a="status"===e?'<div><svg id="checkmark-svg" class="run-animation" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 193.3 193.3"><circle class="cls-1 circle" cx="96.65" cy="96.65" r="94.15"></circle><polyline class="cls-1 checkmark" points="46.9 101.4 76.9 131.4 146.4 61.9"></polyline></svg></div>':"";jQuery(".maincontent").prepend('<div class="messages-container"><div class="messages '+e+'">'+a+'<div class="message">'+t+'</div><div class="icon-close"></div></div></div>')}function close_messages(e){e.fadeOut(300,function(){$j(this).remove()})}function page_loader(){document.getElementById("page-loader")||$j("body").append('<div id="page-loader"><div class="modal-spinner"></div></div>')}function remove_page_load(){$j("#page-loader").remove()}function popoverCalcPos(e){var t=$j("ul",e);if(t.length){var a=$j("a",e).width()/2,r=parseInt($j("a",e).css("padding-right"))+parseInt($j("a",e).css("margin-right"))+a-50-9;t.css({right:r+"px"});var n=t.offset(),o=n.left,s=n.top;o<0&&(t.offset({top:s,left:10}),e.addClass("calc-left"));var i=t[0].getBoundingClientRect().left+t.outerWidth();const c=$j(window).width();if(i>c){const a=i-c+10;e.addClass("calc-right"),t.css({right:r+a+"px"})}}}function popoverClearPos(){$j(".popover").removeClass("active"),$j(".popover > ul").removeAttr("style")}function body_overlay(e="show",t=!1){"hide"===e?($j(".js-dark-overlay").remove(),$j("body").removeClass("js-disabled"),$j("body").removeAttr("data-overlay-toggle"),void 0!==t&&!1!==t&&($j("#"+t).removeClass("js-overlay-show"),$j("body").removeAttr("data-overlay-toggle")),bodyOverlay.isActive=!1):($j('<div class="js-dark-overlay"></div>').appendTo("body"),$j("body").addClass("js-disabled"),void 0!==t&&!1!==t&&($j("#"+t).addClass("js-overlay-show"),$j("body").attr("data-overlay-toggle",t)))}function move_nav(){window.matchMedia("(max-width: 768px)").matches?$j("nav").insertAfter($j("#header-wrapper")):($j(".logo, nav, .responsive-menu-button, .search, .responsive-search-button").removeAttr("style"),1!==$j(".header").find("nav").length&&$j("nav").appendTo($j(".header")))}function update_main_height(){if($j("#container").height()<windowHeight){var e=windowHeight-$j("#footer").height()-92;$j("#maincontent").css({"min-height":e})}}function user_tabs_menu(){var e=$j("#tabs .tabs.secondary").html();if(e&&($j("#main .container").prepend('<div id="sidebar-left"><ul class="tabs secondary">'+e+"</ul>"),$j("#tabs > .tabs.secondary").remove()),$j(".primary > li.active").length){var t=$j(".primary > li.active").offset().left;t>windowWidth&&$j(".primary").animate({scrollLeft:t},100)}if($j(".secondary > li.active").length){var a=$j(".secondary > li.active").offset().left;a>windowWidth&&$j(".secondary").animate({scrollLeft:a},100)}}function switch_sticky(e){"dark"===e?($j("#header-wrapper").removeClass("sticky-header").addClass("black-header"),$j(".logo img").attr("src",dynamic_data.logoPath||"")):($j("#header-wrapper").addClass("sticky-header").removeClass("black-header"),$j(".logo img").attr("src",dynamic_data.reverseLogoPath||""))}function watch_header_menu(e){return"white"===e&&$j("#header-wrapper").hasClass("black-header")?switch_sticky(e):"dark"===e&&$j("#header-wrapper").hasClass("sticky-header")?switch_sticky(e):void 0}$window.resize(function(){windowWidth=$window.width()}),$document.on("click",".messages .icon-close",function(e){close_messages($j(this).closest(".messages"))}),$document.on("click",".js-dark-overlay",function(){var e=$j("body").attr("data-overlay-toggle");void 0!==e&&!1!==e?body_overlay("hide",e):body_overlay("hide")});var initSoundsnap=function(){"use strict";return{initCollapse:function(){jQuery(".js-collapse-trigger").on("click",function(e){e.preventDefault();var t=jQuery(this).closest(".js-collapse-container"),a=jQuery(this).attr("data-js-collapse");if(void 0!==a&&!1!==a){var r=jQuery(this).attr("data-js-persistent");void 0!==r&&!1!==r?(jQuery("#"+a).show(),jQuery(this).css("cursor","text")):jQuery("#"+a).slideToggle("50")}else t.find(".js-collapse-items").slideToggle("50");var n=jQuery(this).attr("data-js-text");if(void 0!==n&&!1!==n){var o=jQuery(this).text();jQuery(this).attr("data-js-text",o),jQuery(this).text(n)}t.toggleClass("js-collapse-active")})}}}();function clickToCopy(e,t){jQuery(document).on("click","#"+e,function(e){e.preventDefault()});var a=document.getElementById(t);a.select(),a.setSelectionRange(0,99999),document.execCommand("copy"),document.getElementById(e).innerHTML="Copied!"}page.addLoadEvent(initSoundsnap.initCollapse),$j(function(){var e;move_nav(),$j(".maincontent").offset()&&($window.scrollTop()>=72&&watch_header_menu("white"),$window.scroll(function(){$j(this).scrollTop()>=72?watch_header_menu("white"):$j(".responsive-search-button").hasClass("search-close")||watch_header_menu("dark")})),$j(".responsive-search-button").click(function(){document.querySelector("#search").classList.toggle("show-search"),$j(this).toggleClass("search-close"),$j(this).hasClass("search-close")?watch_header_menu("white"):$window.scrollTop()<72&&watch_header_menu("dark")}),$j(".js-slide-toggle-trigger").on("click",function(){$j(this).hasClass("toggle-left")?($j(".js-slide-toggle").eq(0).hide(),$j(".js-slide-toggle").eq(1).show(),$j(this).removeClass("toggle-left").addClass("toggle-right")):($j(".js-slide-toggle").toggle(),$j(this).removeClass("toggle-right").addClass("toggle-left"))}),$window.resize(function(){move_nav()}),$j(".responsive-menu-button").on("click",function(){body_overlay("show","main-nav")}),$j(".menu-close").on("click",function(){body_overlay("hide","main-nav")}),$document.on("click",".more-info",function(e){e.preventDefault(),$j(this).closest("div.audio-row").next(".audio-info").slideToggle("100"),$j(this).toggleClass("closed")}),$j(".icon-info").on("mouseenter touchstart",function(){var e=$j(this).next(".info-tooltip"),t=e.width(),a=$j(this).offset(),r=a.left;a.top;r+t>=windowWidth?e.css({left:"auto",right:"-24px"}):e.css({left:"auto",right:0})}),$j(document).on("click",".popover > a",function(e){var t=$j(this).parent(".popover");t.hasClass("js-hover")||(e.preventDefault(),$j(".popover").removeClass("active"),t.addClass("active"),popoverCalcPos(t))}),$j(document).on("mouseenter",".popover",function(){clearTimeout(e);var t=$j(this);t.hasClass("js-hover")&&(popoverClearPos(),t.addClass("active")),t.hasClass("js-calc")&&popoverCalcPos($j(this))}),$j(document).on("mouseleave",".popover",function(){clearTimeout(e);var t=$j(this);e=setTimeout(function(){t.removeClass("active")},500)}),$j(document).on("click","body",function(e){!$j(e.target).closest(".popover").length&&$j(".popover").hasClass("active")&&popoverClearPos()})});let clickToCopy2=function(e){const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999);const a=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);return document.execCommand("copy"),document.body.removeChild(t),!!a&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(a),!0)};function fav_loader(e,t){var a=$j(".fav-container[data-nid="+e+"]");"show"===t&&(a.removeClass("active"),a.prepend('<div class="spin-loader"></div>'),$j(".favorite_message",a).empty()),"hide"===t&&$j(".spin-loader",a).remove(),"over-show"===t&&(a.prepend('<div class="spin-loader"></div>'),$j(".favorites_groups").css({opacity:"0.3"})),"over-hide"===t&&($j(".spin-loader",a).remove(),$j(".favorites_groups").css({opacity:"1"}))}var $nid;$j(document).on("submit",".favorites_groups form",function(e){e.preventDefault();var t=$j(this).parents(".fav-container").attr("data-nid");$j(".fav-container[data-nid="+t+"] .fav-group-add-button").trigger("click")}),$j(document).on("click",".fav-group-add-button",function(e){e.preventDefault();var t=$j(this).parents(".fav-container"),a=t.attr("data-nid"),r=$(t.get(0).querySelector("#title-fav-group-"+a)),n=r.val(),o="title="+n;return n.length?(fav_loader(a,"show"),fetch("/favorites_group/add/"+a+"?ajax=true&"+o).then(e=>{200===e.status?(favorites.add(a),fav_loader(a,"hide"),success_message("status","Added to your Favorites!"),favorites.reloadFavGroups()):fav_loader(a,"hide")})):r.addClass("error"),!1}),$j(document).on("click",".favorites_groups > ul > li > a.fav-add",function(){var e=$j(this).parents(".fav-container").attr("data-nid"),t=$j(this).attr("data-gid");return t&&(fav_loader(e,"show"),fetch("/favorite_nodes/add/"+e+"/"+t+"?ajax=true").then(t=>{200===t.status&&(favorites.add(e),fav_loader(e,"hide"),success_message("status","Added to your Favorites!"))})),!1}),$j(document).on("click",".ojoo-icon-favorite",function(e){var t=$j(this).parent(".fav-container");$nid=t.attr("data-nid");var a=$j(this);(e.preventDefault(),a.hasClass("active"))&&confirm_dialog({url:$j(this).attr("href"),class:"confirm-delete",title:"Remove from favorites",message:"Are you sure you want to<br>remove the "+getAudioTypeSingular+" from your favorites?",button:"Remove"})}),jQuery(document).on("click",".audio-share-copy",function(e){e.preventDefault();var t=jQuery(this).attr("href");!0===clickToCopy2(t)&&success_message("status","The link was copied."),jQuery(".share-container").removeClass("active")}),jQuery(document).on("click",".audio-share-facebook",function(e){if("undefined"!=typeof FB){var t=jQuery(this).attr("href").split("?u=").pop();e.preventDefault(),FB.ui({display:"popup",method:"share",href:t},function(e){})}}),$j(document).on("click",".confirm-delete",function(e){e.preventDefault(),fav_loader($nid,"show"),fetch("/favorite_nodes/delete/"+$nid+"?ajax=true").then(e=>{200===e.status&&(window.location.href.indexOf("favorites")>-1&&$j("#node-"+$nid).stop().animate({opacity:"0"},800).slideUp(),favorites.remove($nid),fav_loader($nid,"hide"),success_message("status","Removed from your Favorites!"))})}),$j(document).on("click",".fav-group-delete-button",function(e){e.preventDefault(),confirm_dialog({url:$j(this).attr("href"),class:"",title:"Delete list",message:"Are you sure you want to delete this list? This action is irreversible.",button:"Delete list"})}),$j(document).on("click",".fav-group-privacy-button",function(e){e.preventDefault(),confirm_dialog({url:$j(this).attr("href"),class:"",message:"Are you sure you want to change<br>the privacy settings of this list?",button:"Change"})});var checkUser=function(){"use strict";return{initCheckUser:function(){jQuery.fn.typeWatch=function(e){var t=jQuery.extend({wait:750,callback:function(){},highlight:!0,captureLength:2,keyActivate:!0},e);function a(e,a){var r=jQuery(e.el).val();(r.length>t.captureLength&&r.toUpperCase()!=e.text||a&&r.length>t.captureLength)&&(e.text=r.toUpperCase(),e.cb(r))}return this.each(function(e){!function(e){if("TEXT"==e.type.toUpperCase()||"TEXTAREA"==e.nodeName.toUpperCase()){var r={timer:null,text:jQuery(e).val().toUpperCase(),cb:t.callback,el:e,wait:t.wait};t.highlight&&jQuery(e).focus(function(){this.select()}),t.keyActivate?jQuery(e).keydown(function(e){var t=r.wait,n=!1;13!=e.keyCode&&9!=e.keyCode||"TEXT"!=this.type.toUpperCase()||(t=1,n=!0),clearTimeout(r.timer),r.timer=setTimeout(function(){a(r,n)},t)}):jQuery(e).blur(function(){a(r,!1)})}}(this)})};var e={callback:function(e){!function(e){if(!e)var e="edit-name"==jQuery("input[data-checkuser]:text:focus").attr("id")?"name":"mail";jQuery("#check-"+e).html('<div class="spin-loader"></div>'),jFetch("/checkuser",{method:"post",body:{input:e,value:document.querySelector("#edit-"+e).value}}).then(ok).then(asJson).then(t=>{0==t.success?jQuery("#edit-"+e).addClass("error"):jQuery("#edit-"+e).removeClass("error"),jQuery(".spin-loader").remove(),jQuery("#check-"+e).html(t.msg)})}()},wait:0,keyActivate:!1};jQuery("input[data-checkuser]").typeWatch(e),jQuery('<div id="check-name"></div>').insertAfter("#edit-name[data-checkuser]"),jQuery('<div id="check-mail"></div>').insertAfter("#edit-mail[data-checkuser]")}}}();jQuery(function(){checkUser.initCheckUser()});var loginTemplate=function(){"use strict";return{initLoginTemplate:function(){$j(".login_template input.form-submit, #user_edit .form-submit").click(function(e){var t=!1;if($j("#edit-mail").length){var a=$j("#edit-mail");/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(a.val())?a.removeClass("error-mail"):(a.addClass("error-mail"),t=!0),a.hasClass("error-mail")&&(t=!0)}$j("#edit-pass-pass2").length&&((a=$j("#edit-pass-pass2")).val()!==$j("#edit-pass-pass1").val()?(a.addClass("error-pass"),t=!0):a.removeClass("error-pass")),t&&e.preventDefault()})}}}();function email_verification_message(e){var t="<div><img src='"+(dynamic_data.confirmMailImage||"")+"'><h2>Confirm your email</h2><p>We have sent an email to "+e+" with a verification link. Please follow the instructions to confirm your email and get your free sound.</p><div>Wrong email? <a href='/register' class='primary-link' rel='modal:open'>Create new account</a></div>";$j(t).modal()}function confirm_dialog(e){var t='<div class="modal js-confirm-dialog"><h2>'+e.title+"</h2><p>"+e.message+"</p><div><a href='"+e.url+"' "+(e.extra?e.extra:"")+" id='"+(e.id?e.id:"")+"' class='form-submit btn-destructive "+(e.class?e.class:"")+"' role='button'>"+e.button+"</a></div></div>";$j(t).modal()}function collapseAutoAttach(){for(var e,t,a=document.getElementsByTagName("fieldset"),r=0;t=a[r];r++)if(hasClass(t,"collapsible")&&0!=(e=t.getElementsByTagName("legend")).length){e=e[0];var n=document.createElement("a");for(n.href="#",n.onclick=function(){return toggleClass(this.parentNode.parentNode,"collapsed"),hasClass(this.parentNode.parentNode,"collapsed")||(collapseScrollIntoView(this.parentNode.parentNode),"undefined"!=typeof textAreaAutoAttach&&textAreaAutoAttach(null,this.parentNode.parentNode)),this.blur(),!1},n.innerHTML=e.innerHTML;e.hasChildNodes();)removeNode(e.childNodes[0]);e.appendChild(n),collapseEnsureErrorsVisible(t)}}function collapseEnsureErrorsVisible(e){if(hasClass(e,"collapsed")){var t=[];t=(t=(t=t.concat(e.getElementsByTagName("input"))).concat(e.getElementsByTagName("textarea"))).concat(e.getElementsByTagName("select"));for(var a=0;a<3;a++)for(var r=0;r<t[a].length;r++)if(hasClass(t[a][r],"error"))return removeClass(e,"collapsed")}}function collapseScrollIntoView(e){var t=self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,a=self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,r=absolutePosition(e);r.y+e.scrollHeight>t+a&&(e.scrollHeight>t?window.scrollTo(0,r.y):window.scrollTo(0,r.y+e.scrollHeight-t))}$j(function(){loginTemplate.initLoginTemplate()}),jQuery.fn.extend({initModalOptions:function(){jQuery.modal.defaults.fadeDuration=50,jQuery(window).on(jQuery.modal.BEFORE_OPEN,function(e,t){jQuery.modal&&jQuery.modal.isActive()}),jQuery(document).on("click",".modal-link",function(e){var t="";return jQuery(this).attr("data-modal")&&(t+=" modal-"+jQuery(this).attr("data-modal")),jQuery(this).attr("data-modal-transparent")&&(t+=" modal-transparent "),t+=" modal",jQuery(this).modal({fadeDuration:50,modalClass:t}),!1})}}),jQuery(function(){jQuery.fn.initModalOptions()}),$j(document).on("click",".js-confirm-dialog .form-submit",function(){$j.modal.close()}),jQuery(window).on(jQuery.modal.OPEN,function(e,t){labelAnimation.initlabelAnimation(),labelAnimation.initRequiredFields(),loginTemplate.initLoginTemplate(),checkUser.initCheckUser();var a=window.location.href;jQuery(".modal form#user_login_block, .modal form#user_register").submit(function(e){e.preventDefault();var t=jQuery(this),r=(t.attr("id"),jQuery(".modal-message"));t.prepend("<div class='spin-loader'></div>");var n=jQuery(".spin-loader"),o=t.serializeArray(),s=JSON.stringify(o);return jQuery.ojooAjax({type:"POST",data:{edit:s},url:"/login_callback",dataType:"html",success:function(e){var t=jQuery.parseJSON(e);t.message?(r.html(t.message),n.remove(),"undefined"!=typeof grecaptcha&&grecaptcha.reset()):t.destination?window.location=t.destination:t.action?window.location=t.action:window.location=a},error:function(e,t,a){n.remove(),r.addClass("error").html("Error signing user:  "+a)}}),!1})}),isJsEnabled()&&page.addLoadEvent(collapseAutoAttach);const pairs=Object.entries,fromPairs=Object.fromEntries,filterToPageType=mapValues(termsConfig,e=>e.pageName),pageTypeToFilter=switchKeysWithValues(filterToPageType),OjooVuePlugin={install(e,t={}){e.prototype.filterToPageType=filterToPageType,e.prototype.pageTypeToFilter=pageTypeToFilter,e.prototype.$util={log:(...e)=>console.log(...e)},e.prototype.$utils=e.prototype.$util,e.prototype.$apps={get url(){return url},get categories(){return categories}},e.prototype.$app=e.prototype.$apps}};function isCssTruncated({offsetWidth:e,scrollWidth:t}){return e<=t}function buildThresholdList(){let e=[];for(let t=1;t<=20;t++){let a=t/20;e.push(a)}return e.push(0),e}Vue.use(OjooVuePlugin),Vue.directive("truncate",function(e,{modifiers:t}){const a=t.max?fromDynamicData("truncateMax"):fromDynamicData("truncateMin"),r=e.textContent.trim();r.endsWith("..")||a+1<r.length&&(e.textContent=truncate(r,a),e.title=r)}),Vue.component("extra-asset-loader",{name:"extra-asset-loader",template:'<div style="position:relative;width: 25px;"><div class="spin-loader" style="position:relative"></div></div>'});const apps={debug:!1,doMount:(e,t,a)=>{const r=document.querySelector(a);r?(t.$mount(r),apps.debug&&Ojoo.info("mounted:",e,"on dom element: ",a)):apps.debug&&Ojoo.warn("not mounted:",e,"since dom element",a,"is not present")}},type={str:{type:String,default:""},bool:{type:Boolean,default:!1},each:{as:(e,t)=>t.reduce((t,a)=>(t[a]=e,t),{}),asStr:(...e)=>type.each.as(type.str,e)}},parse={trim:e=>e.trim(),mapStr:e=>new Map(e.split(",").map(parse.trim).map(e=>e.split(":").map(parse.trim)))},tryTo={parseJson:e=>({orDefaultTo:(t=null)=>{try{return JSON.parse(e)}catch(e){return t}}})},stringy=JSON.stringify,pathOf=e=>e.join("/"),urlize=e=>e.replace(/[\W_]+/g,"_").replace(/^_|_$/g,"").toLowerCase(),ensure={slash:e=>(e||"").startsWith("/")?e:`/${e}`,array:e=>Array.isArray(e)?e:Array.of(e),no:{slash:e=>e.startsWith("/")?e.slice(1):e}},getAndSetOnUrl=e=>({get(){return this.url[e]},set(t){this.url[e]=t}}),fallbackTheme={theme_name:themeName,theme_prefix:"",searchUrl:location.pathname},prefixAwarePathname=prefixless(location.pathname),themes=Vue.observable({all:Object.values(themesMatrix||{fallbackTheme:fallbackTheme}).reverse().filter(e=>e).map(e=>({url:(e.theme_prefix||"")+prefixAwarePathname,...e,searchUrl:(e.theme_prefix||"")+"/search/audio",prefix:e.theme_prefix||"",name:e.theme_name})),currentThemeName:themeName,selectedThemeName:themeName}),themesMixin={data:()=>({themes:themes.all}),computed:{themesByAttr(){return itemsBy(this.themes,"theme_name","theme_prefix")},selectedTheme(){return this.themesByAttr[themes.selectedThemeName]||fallbackTheme},currentTheme(){return this.themesByAttr[themes.currentThemeName]||fallbackTheme}},methods:{selectTheme(e){themes.selectedThemeName=e},loadTheme(e){this.selectTheme(e),this.selectedTheme.name!==this.currentTheme.name&&url.load({searchParams:{query:"",page:0},pathname:this.selectedTheme.url})}}},tokenPattern=/(\{.*\})/g,replaceToken=(e,t="",a=/(\{.*\})/g)=>e.replace(a,t);function fakePageLoad(e){page_loader(),setTimeout(()=>{remove_page_load(),e()},500)}const url=new Vue({mixins:[themesMixin],data(){return this.pushBase=0,{url:new URL(location)}},computed:{hash:getAndSetOnUrl("hash"),host:getAndSetOnUrl("host"),href:getAndSetOnUrl("href"),origin:getAndSetOnUrl("origin"),port:getAndSetOnUrl("port"),protocol:getAndSetOnUrl("protocol"),search:getAndSetOnUrl("search"),pathname:{get(){return prefixless(this.url.pathname)},set(e){this.url.pathname=e}},searchParams:{get(){return this.url.searchParams},set(e={}){this.setQuery(e)}},searchQuery(){const e=this.pathname.replace(/\/score$/i,"").split("/").reverse()[0]||"";return decodeURI(e).replaceAll("_"," ")},pathParts(){return this.pathname.split("/").filter(out.falsyValues)},firstPathPart(){return this.pathParts[0]||""},lastPathPart(){return this.pathParts[this.pathParts.length-1]||""}},watch:{url:{handler:function(){this.$emit("changed",this.url)},immediate:!0}},methods:{update(){this.url=new URL(location)},stateOf(e=this.url){return{pathname:e.pathname,searchParams:Object.fromEntries(e.searchParams.entries())}},aliasPathFor:(e,t="external")=>ensure.slash(fromDynamicData("urlAliasMatrix",e,t)||""),aliasPath(e,t){return this.aliasPathFor(e,t?"internal":"external")},reWriteTermPath(e,...t){e.startsWith("sub")&&(e=e.slice(3).toLowerCase());const a=termConfigFor(e)||getTermConfigByGeneralName(e),r=this.aliasPathFor(a.siteUrl);return prefixBasePath(replaceToken(r,pathOf(t.map(urlize))).toLowerCase())},changePathTo(e){this.change({pathname:e})},set(e){const t=["hash","host","href","origin","pathname","port","protocol","search","searchParams"];Object.entries(e).forEach(([e,a])=>{if(t.includes(e)||console.info("[ojoo] you are trying to set the nonexisting key:",e),"searchParams"===e)return this.setQuery(a);"pathname"===e&&(a=ensure.slash(a)),this.url[e]=a})},setQuery(e){this.clearQueryParams();for(const[t,a]of Object.entries(e))this.setQueryParam(t,a)},changeQuery(e){this.change({searchParams:e})},clearQueryParams(){Array.from(this.url.searchParams.entries()).forEach(([e])=>{this.url.searchParams.delete(e)})},setQueryParam(e,t,a=(e=>e)){a(t)?this.url.searchParams.set(e,t):this.url.searchParams.delete(e)},setQueryParams(e,t=location.pathname){this.clearQueryParams(),this.change({pathname:t,searchParams:e})},change(e={}){const t=this.stateOf(new URL(location.href));this.set(e);const a=this.stateOf(this.url);is.not.equal(t,a)&&(history.pushState({},null,this.url),this.update())},load(e={}){this.set(e),location=this.url.toString()},loadSearch(e,t={}){this.load({pathname:"/search/audio",searchParams:{query:e},...{}})},changeSearch(e,t={}){this.change({pathname:"/search/audio",searchParams:{query:e},...{}})},singlePageLoad({searchTerm:e,pageType:t,pathname:a}){if("undefined"!=typeof searchApp&&searchApp.mounted){if(location.pathname===a&&searchApp.init.pageType===t&&searchApp.init.searchTerm===e)return;searchApp.initializePageFilter({pageType:t,searchTerm:e}),this.change({pathname:a,searchParams:{}}),searchApp.updateSideNavStick(),searchApp.recalculateHeight()}else this.load({pathname:a})},fullPath(e=""){return e.startsWith("http")?e:`${this.origin}${e}`},loadPage(e){this.setQueryParam("page",e,e=>1!==e),this.load()},loadPageWithoutZero(e){this.setQueryParam("page",e,e=>0!==e),this.load()},arrayParam(e){return urldecode(atob(this.searchParams.get(e)||"")).split(",").filter(e=>e.trim())},intArrayParam(e){return(this.searchParams.get(e)||"").split(",").map(e=>e.trim()).filter(Boolean).map(e=>parseInt(e))},intParam(e,t=0){return parseInt(this.searchParams.get(e))||t},strParam(e,t=""){return urldecode(atob(this.searchParams.get(e)||t))},setPushBase(e){this.pushBase=e},pushToBase(...e){fakePageLoad(()=>{this.change({pathname:[this.pathParts.slice(0,this.pushBase),...e.map(String)].flat().filter(Boolean).join("/")})})},pushPath(...e){fakePageLoad(()=>{this.change({pathname:[this.pathname,...e.map(String)].map(e=>e.split("/")).flat().filter(Boolean).join("/")})})},popPath(){fakePageLoad(()=>{this.change({pathname:this.pathname.split("/").slice(0,-2).join("/")})})}},created(){window.addEventListener("popstate",function(){this.isHandlingPopstate=!0,this.update(),this.isHandlingPopstate=!0}.bind(this))}}),Ojoo={linkComponent:e=>Vue.component(e,{data:()=>({name:e}),template:'<a :class="name" v-on="$listeners"><slot></slot></a>'}),wrapperComponent:(e,t={})=>Vue.component(e,{template:`<div class="${t.class||e}"><slot></slot></div>`}),logger:(e,...t)=>console[e||"log"]("[ojoo]",...t)||!0,log:(e,t,...a)=>(Ojoo.logger("log",e,t,...a),t),info:(...e)=>Ojoo.logger("info",...e),warn:(...e)=>Ojoo.logger("warn",...e),error:(...e)=>Ojoo.logger("error",...e)};function checkIsLoggedIn(e){return!isNaN(parseInt(e))&&parseInt(e)}Ojoo.linkComponent("button-link"),Ojoo.linkComponent("modal-link");const asset=e=>`${dynamic_data.assetsPath||""}/${e}`,is={defined:e=>void 0!==e,string:e=>"string"==typeof e,array:e=>Array.isArray(e),object:e=>"object"==typeof e&&e&&!Array.isArray(e),arrayOrObject:e=>is.array(e)||is.object(e),fn:e=>"function"==typeof e,number:e=>Number.isInteger(e),numeric:e=>is.number(parseInt(e))&&String(parseInt(e))===e,nil:e=>null===e,null:e=>null===e,nonEmptyArray:(e=[])=>!!Array.isArray(e)&&Boolean(e.length),nonEmptyObject:(e={})=>!!is.object(e)&&Boolean(Object.keys(e).length),nonEmptyString:e=>!!is.string(e)&&Boolean(e.length),empty:e=>is.string(e)&&!e||is.object(e)&&0===Object.keys(e).length||is.array(e)&&0===e.length,equal:(e,t)=>{const a=Object.keys;return e&&t&&is.arrayOrObject(e)&&is.arrayOrObject(t)?a(e).length===a(t).length&&a(e).every(a=>is.equal(e[a],t[a])):e===t}},negated={get:(e,t)=>(...a)=>!e[t](...a)};is.not=new Proxy(is,negated);const out={falsyValues:e=>e};function mapValues(e,t){return fromPairs(pairs(e).map(([e,a],r,n)=>[e,t(a,r,n)]))}function switchKeysWithValues(e){return fromPairs(pairs(e).map(([e,t])=>[t,e]))}const containing=e=>new RegExp(e,"ig"),items={uniq:e=>Array.from(new Set(e)),randomly:(e,t)=>Math.random()-.5,asc:(e,t)=>e-t,desc:(e,t)=>items.asc(t,e),by(e){function t(t,a){return items.asc(t[e],a[e])}return t.asc=t,t.desc=((e,a)=>t(a,e)),t},filteredFirstIn({filtered:e,items:t}){const a=[],r=[];return t.forEach(([t,n,o,s])=>{(e.includes(o||t)?a:r).push([t,n,o,s])}),[...a,...r]},selectedOne(e,t){if(e.length){const a=e[0];return[t.find(e=>e.name===a||e.subcategories.some(e=>e.name===a))]}return items.filteredFirstIn(e,t)},missingInFrom:(e,t,a=[])=>[...Object.keys(t).filter(t=>!e[t]),...a].reduce((e,a)=>(e[a]=t[a],e),{}),selecting:(e,...t)=>t.reduce((t,a)=>(t[a]=e[a],t),{}),pick:(e,...t)=>t.reduce((t,a)=>(e[a]&&(t[a]=e[a]),t),{}),removeNullyValues:e=>Object.keys(e).reduce((t,a)=>{const r=e[a];return(is.number(r)||r&&is.nonEmptyArray(r)||r&&is.nonEmptyObject(r))&&(t[a]=r),t},{}),to:(e,{apply:t}={apply:e=>e})=>a=>t(a[e]),startingWith:e=>(t="")=>t&&new RegExp(`^${e}`,"ig").test(t),only:e=>e},facetByCount=([,e],[,t])=>t-e,fn={debounced:(e,t=100)=>{let a;return()=>{clearTimeout(a),a=setTimeout(e,t)}}},update=e=>{const t=([t,a])=>Vue.set(e,t,a);return{with:e=>Object.entries(e).forEach(t)}},px=e=>`${e}px`;function getOnObject(e,t=null){return(...a)=>a.reduce((e,a)=>e&&e[a]?e[a]:t,e)}function countSubIn(e,t){return(t.match(new RegExp(e,"ig"))||[]).length}function trim(e="",t="[\\W]"){return e.replace(new RegExp(`(^${t}+|${t}+$)`,"ig"),"")}function occurencesOf(e){return{countedIn:t=>countSubIn(e,t),isIn:t=>Boolean(countSubIn(e,t)),isTimesIn:(t,a)=>t===countSubIn(e,a),isMinTimesIn:(t,a)=>t<=countSubIn(e,a),isMaxTimesIn:(t,a)=>countSubIn(e,a)<=t}}function propByPath(e,t,a){return ensure.array(t).reduce((e,t)=>e&&e[t]?e[t]:a,e)}function findByPaths(e,t,a){return t.reduce((t,a)=>t||propByPath(e,a,void 0),void 0)||a}const fromDynamicDataWithDefault=e=>getOnObject(dynamic_data,e),fromDynamicData=fromDynamicDataWithDefault(""),fromDynamicDataAsObject=fromDynamicDataWithDefault({}),fromDynamicDataAsInt=fromDynamicDataWithDefault(0),fromDynamicDataAsArray=fromDynamicDataWithDefault([]),fromDynamicDataAsUndefined=fromDynamicDataWithDefault(void 0),fromDynamicDataAsBoolean=fromDynamicDataWithDefault(!1);function itemByProp(e,t,a){return Object.values(a).find(a=>a[e]==t)}const aFacet=(e,t={})=>({hasDefaultFilter:!1,isHierarchial:!1,generalName:e,siteTitle:capitalize(e),facetFields:e,defaultSearchField:e,...t}),searchFields={...dynamic_data.termsConfig,libraryFacet:{...termConfigFor("artist")},artist:{...termConfigFor("artist")},tag:{...termConfigFor("tag")},playlist:{...termConfigFor("playlist")},category:{...termConfigFor("category")},subCategory:{...termConfigFor("category"),...aFacet("vocab.category.lvl.1",{generalName:"subcategories"})},subGenre:{...termConfigFor("genre"),...aFacet("vocab.genre.lvl.1",{generalName:"subgenre"})},playTime:aFacet("audio.playTime",{generalName:"Playtime",siteName:"Length"}),bpm:aFacet("audio.bpm")};function termConfigFor(e,t=dynamic_data.termsConfig,a=termOverride){return t[e=a[e]||e]}function searchFieldOf(e="category"){return e="subCategory"===e&&"genre"===termOverride.category?"subGenre":e,searchFields[e].defaultSearchField}const searchFieldLvl1Of=(e="category")=>termConfigFor(e).defaultSearchFieldLv1,pageTypeOf=e=>termConfigFor(e).pageName,siteNameOf=e=>termConfigFor(e).siteName,siteUrlOf=(e="category")=>termConfigFor(e).siteUrlField,getTermConfigByGeneralName=(e,t=dynamic_data.termsConfig)=>itemByProp("generalName",e,t),getTermConfigBySiteName=(e,t=dynamic_data.termsConfig)=>itemByProp("siteName",e,t),getTermConfigByPageType=(e,t=dynamic_data.termsConfig)=>itemByProp("pageName",e,t),userDataAPI="/api/artist",collectionDataAPI="/api/taxonomy/term",findFromDynamicData=(e,...t)=>findByPaths(dynamic_data,t,e);function toMinSeconds(e){return e?`${Math.floor(e/60)}:${String(e%60).padStart(2,"0")}`:"0:00"}function fromMinSeconds(e){if(!e)return 0;const t=String(e).split(":");return 1===t.length?anInt(t[0]):60*anInt(t[0])+anInt(t[1])}const uid=fromDynamicData("user","uid"),isLoggedIn=!!uid&&checkIsLoggedIn(uid),getAudioTypeSingular=fromDynamicData("audioTypeSingular").toLowerCase(),getAudioTypePlural=fromDynamicData("audioType"),getAudioTypePluralLower=fromDynamicData("audioType").toLowerCase(),random={id:()=>Math.random().toString(36).slice(2),number:e=>Math.floor(Math.random()*e),ly:()=>()=>Math.random()-.5,itemFrom:e=>e[random.number(e.length)],phrasesOf(e=[],t=5){if(!t||!e.length)return[];const a=Array(4*t).fill().map(()=>uniq(Array(t).fill().map(()=>this.itemFrom(e))));return uniq(a.map(e=>e.join(" ")))}};function f(e=[],t=[]){[].concat(...e.map(e=>t.map(t=>[].concat(e,t))))}function cartesianOf(e,t,...a){return t?cartesianOf(f(e,t),...a):e}function combinationsOf(e){return e.flatMap((t,a)=>e.slice(a+1).map(e=>[t,e]))}function capitalize(e=""){return e.charAt(0).toUpperCase()+e.slice(1)}const capitalizeEachWord=e=>e.split(/[ _]/gi).map(capitalize).join(" "),removeItemFrom=(e,t)=>{const a=t.indexOf(e);return-1<a?t.splice(a,1):{}};var anInt=e=>parseInt(e)||0;const clamp=(e,t,a)=>Math.min(Math.max(a,e),t),minMaxVal=clamp,slashLess=e=>e.startsWith("/")?e.substr(1):e,trimAndLower=(e="")=>{if(is.not.string(e))throw new Error(`expecting a string but got + ${typeof e}, ${e}, ${String(e)}`);return e.trim().toLowerCase()},thousands_separators=(e=0)=>{if(e<10)return e;var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")};function asArray(e){return is.array(e)?e:is.object(e)?Object.values(e):[e]}function itemsBy(e,...t){return t.reduce((t,a)=>asArray(e).reduce((e,t)=>t[a]?e[t[a]]&&e[t[a]]!==t?e:(e[t[a]]=t,e):e,t),{})}const convertBpmToClient=e=>e?Math.round(e/Math.pow(10,2)):40,convertBpmToSearchEngine=e=>e*Math.pow(10,2),load={js:e=>new Promise((t,a)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=a,document.body.appendChild(r)})};Vue.component("limit-length",{props:{of:{type:String,required:!0},limit:{type:Number,required:!0}},computed:{limitedOf(){return this.of.slice(0,this.of.slice(0,this.limit).lastIndexOf(" "))}},template:'<span v-once>\n      <template v-if="of.length <= limit">\n        {{ of }}\n      </template>\n      <template v-else>\n        {{ limitedOf }} <slot></slot>\n      </template>\n    </span>'}),Vue.component("social-icon",{props:{linkTo:{type:String,default:""},platform:{type:String,default:"web"}},template:'<a v-once\n      v-if="linkTo"\n      :href="linkTo"\n      target="_blank"\n      :class="\'icon-\'+platform"\n    ></a>'}),Vue.component("pagination",{name:"pagination",props:{current:{type:Number,required:!0},total:{type:Number,required:!0}},computed:{numberDigits(){return String(this.total).length},isFirst(){return this.current<=1},isLast(){return this.total<=this.current},nextHref(){if(this.isLast)return"";const e=new URL(location);return e.searchParams.set("page",this.current+1),e.toString()},prevHref(){if(this.isFirst)return"";const e=new URL(location);return e.searchParams.set("page",this.current-1),e.toString()}},methods:{nextSpa(){this.isLast||this.goTo(this.current+1)},prevSpa(){this.isFirst||this.goTo(this.current-1)},valid:e=>!isNaN(e)&&"number"==typeof e,goTo(e){if(!this.valid(e))return this.$refs.numInput.value=this.current;e=minMaxVal(1,this.total,e),this.$refs.numInput.values=e,this.$emit("goto",e)}},template:'<div v-if="1 < total" class="pagination">\n      <link-to\n        id="previous-page"\n        :class="[\'ojoo-icon-caret-left\', \'button-icon\', \'secondary\',\'override-sm\', {disabled: isFirst}]"\n        :href="prevHref"\n        :spa-open="prevSpa"\n      ></link-to>\n      <input\n        class="current form-text input-transparent"\n        :value.number="current"\n        :maxlength="numberDigits"\n        ref="numInput"\n        @change="goTo(parseInt($event.target.value))"\n        @keydown.enter="$event.target.blur()"\n        @keydown.esc="$event.target.blur()"\n      />\n      <span class="total">of {{ total }}</span>\n      <link-to\n        id="next-page"\n        :class="[\'ojoo-icon-caret-right\', \'button-icon\', \'secondary\', \'override-sm\', {disabled: isLast}]"\n        :href="nextHref"\n        :spa-open="nextSpa"\n      ></link-to>\n    </div>'});const err={handler:()=>e=>console.error(e),state:e=>Ojoo.error(e),search:({message:e,status:t})=>{switch(Ojoo.error("search error - status: ",t,"- message:",e),t){case 429:searchApp.too_many_requests();break;case 403:url.load({pathname:"notfound"})}return e.split(" ").length>0&&"timeout"===e.split(" ")[0]&&(document.body.innerHTML+=blockerMessage("Sorry we are unable to reach the search service. Please wait a few minutes and try again.","Retry Search")),{message:e,status:t}},rejectWith:e=>{const t=`${e}: ${req.status} - ${req.statusText}`;Ojoo.error(t),Promise.reject(t)},handleJson:e=>(e.ok||err.rejectWith("request error"),e.json().then(({error:e,data:t})=>(e.code&&err.rejectWith("backend error"),t)))};Vue.component("no-favorite",{props:{hasPermissionToEditList:{type:Boolean,default:!1}},template:`<div>\n      <div class="description" v-if="hasPermissionToEditList">\n        ${getAudioTypePlural} you favorite will appear here.\n        To add a  ${getAudioTypeSingular} to your favorites, click on the Star icon when browsing ${getAudioTypePlural.toLowerCase()}.\n      </div>\n      <div v-else class="description">\n        Once the user adds ${getAudioTypeSingular} they will appear here.\n      </div>\n    </div>`}),Vue.component("no-download",{template:`<div>\n      <div class="empty_header">\n        You haven’t downloaded any ${getAudioTypePlural.toLowerCase()}\n      </div>\n      <div class="description">\n        ${getAudioTypePlural} you download will appear here in case you wish to re-download them.\n      </div>\n    </div>`}),Vue.component("error-message",{props:{messages:{type:Array,required:!0}},template:'<div class="messages error">\n    <div class="message">\n      <ul>\n        <li v-for="message in messages" :key="message"> {{ message }}</li>\n      </ul>\n    </div>\n    <div class="icon-close"></div>\n  </div>'}),Vue.component("status-message",{props:{messages:{type:Array,required:!0}},template:'<div class="messages status">\n    <div>\n      <svg id="checkmark-svg" class="run-animation" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 193.3 193.3">\n        <circle class="cls-1 circle" cx="96.65" cy="96.65" r="94.15"></circle>\n        <polyline class="cls-1 checkmark" points="46.9 101.4 76.9 131.4 146.4 61.9"></polyline>\n      </svg>\n    </div>\n    <div class="message">\n      <ul>\n        <li v-for="message in messages" :key="message"> {{ message }}</li>\n      </ul>\n    </div>\n    <div class="icon-close"></div>\n  </div>'}),Vue.component("message-container",{props:{errors:{type:Array,required:!0},status:{type:Array,required:!0}},template:'<div class="messages-container">\n      <error-message :messages="errors" v-if="errors.length">\n      </error-message>\n      <status-message :messages="status" v-if="status.length">\n      </status-message>\n    </div>'});const messagesApp=new Vue({data(){const e=fromDynamicDataAsArray("messages");return{errors:void 0!==e.error?e.error:[],status:void 0!==e.status?e.status:[]}},methods:{showError(e){this.errors.push(e)},showMessage(e){this.status.push(e)}},template:'<message-container \n      v-if="errors.length || status.length"\n      :errors="errors"\n      :status="status"\n    ></message-container>'});function truncate(e="",t=12,a=".."){return is.array(e)?e.map(e=>truncate(e,t,a)):t+1<e.length?e.slice(0,t)+a:e}Vue.filter("ensureSlash",ensure.slash),Vue.filter("mapStr",parse.mapStr),Vue.filter("truncate",truncate),Vue.filter("capitalize",capitalize);const mapOver=(e,t={})=>t[e]||t.default;Vue.filter("mapOver",mapOver);const phpParse=e=>"string"==typeof e?Boolean(parseInt(e)):Boolean(e),freshModalApp=()=>new Vue({data(){const e="undefined"!=typeof favorites;return{formData:dynamic_data.deleteForm||dynamic_data.favorites_group_share,favoritesExist:e,shareForm:dynamic_data.favorites_group_share?dynamic_data.favorites_group_share.form:"",favorites:e?favorites:null}},computed:{title(){return this.favoritesExist&&favorites.listTitle?favorites.listTitle:this.formData.title||""},isPublic(){return!!this.favoritesExist&&favorites.isPublic},isLoading(){return!!this.favoritesExist&&favorites.isLoading},gid(){return this.favoritesExist&&favorites.activeFavGroup?favorites.activeFavGroup.gid:""},error(){return this.formData.error}},watch:{isPublic(e){e&&Vue.nextTick(()=>this.setupFormLabels())}},methods:{toggleFavoriteListPrivacy(){favorites.$emit("toggle-privacy")},setupFormLabels(){labelAnimation.initlabelAnimation(),labelAnimation.initRequiredFields()}},mounted(){this.setupFormLabels()}});function fakeFetch(e,{useTimeoutLength:t=5e3,body:a,...r}){return new Promise(function(e,r){setTimeout(()=>{e(a)},t)})}jQuery(window).on(jQuery.modal.OPEN,()=>{apps.doMount("modalApp",freshModalApp(),".jquery-modal .modalcontent")});const ary={addTo:(e,t)=>[...asArray(e),...asArray(t)],removeFrom:(e,t)=>(t=asArray(t),asArray(e).filter(e=>!t.includes(e)))},api={favoriteGroups:{togglePrivacy:e=>fetch(`/favorites_group/api-privacy/${e}`).then(err.handleJson)}};Vue.component("switch-toggle",{props:{classname:String,value:{type:Boolean,default:!1},isenabled:{type:Boolean,default:!0}},template:'<div class="slide-wrapper" :class="classname ? classname : \'\' ">\n    <slot name="left"></slot>\n    <a @click="isenabled ? $emit(\'changed\', !value) : \'\'" \n       class="slide-button" \n       :class="value ? \'on\' : \'off\'"\n      ><div></div>\n    </a>\n    <span>\n      <slot name="right"></slot>\n    </span>\n  </div>'}),Vue.component("privacy-switch",{props:{isPublic:Boolean,isLoading:Boolean,gid:{type:String,required:!0}},template:'<div class="slide-wrapper center">\n    <span>This list is {{ isPublic ? \'public\' : \'private\' }}</span>\n    <span v-if="isLoading" class="spin-loader"></span>\n    <a\n      :href="\'/favorites_group/api-privacy/\'+ gid"\n      @click.prevent="$emit(\'toggle-privacy\')"\n    >\n      <span\n        class="slide-button"\n        :class="isPublic ? \'on\' : \'off\'"\n      ><div></div></span>\n    </a>\n  </div>'});const $gridBreakpoints={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1600},viewPort=new Vue({data(){return{windowHeight:window.innerHeight,windowWidth:window.innerWidth,updateWindowSizeDebounced:fn.debounced(this.updateWindowSize,300)}},computed:{breakpoint(){const e=Object.entries($gridBreakpoints).reverse();let[t,a]=e.find(([e,t])=>t<=this.windowWidth);return t},isSMorWider(){return this.isMinBreakPoint("sm")},isMDorWider(){return this.isMinBreakPoint("md")},isLGorWider(){return this.isMinBreakPoint("lg")},isXLorWider(){return this.isMinBreakPoint("xl")},isXLLorWider(){return this.isMinBreakPoint("xxl")}},methods:{isMaxBreakPoint(e){return $gridBreakpoints[this.breakpoint]<=$gridBreakpoints[e]},isMinBreakPoint(e){return $gridBreakpoints[e]<=$gridBreakpoints[this.breakpoint]},updateWindowSize(){this.windowHeight=window.innerHeight,this.windowWidth=window.innerWidth}},created(){window.addEventListener("resize",this.updateWindowSizeDebounced)},beforeDestroy(){window.removeEventListener("resize",this.updateWindowSizeDebounced)}});function mod(e,t){return(e%t+t)%t}Vue.component("link-to",{props:{href:{type:String,required:!0},spaOpen:{type:Function,required:!0}},data:()=>({openWithBrowser:()=>!0}),template:'<a\n    :href="href"\n    @click.exact.prevent="spaOpen"\n    @click.ctrl="openWithBrowser"\n    @click.meta="openWithBrowser"\n  ><slot></slot></a>'}),Vue.component("pop-over",{props:{popoverClass:String,default:""},template:'<li class="popover js-calc">\n      <slot name="default"></slot>\n      <ul :class="popoverClass">\n        <slot name="popover"></slot>\n      </ul>\n    </li>'}),Ojoo.wrapperComponent("popover-header"),Vue.component("popover-hover",{props:{popoverClass:String,default:""},data:()=>({show:!1,showTimer:null}),methods:{setShow(e){clearTimeout(this.showTimer),this.showTimer=setTimeout(()=>this.show=e,e?50:500)},open(){this.setShow(!0)},close(){this.setShow(!1)},toggle(){this.setShow(!this.show)}},template:'<ul \n      @mouseenter="open"\n      @mouseout="close"\n      @mouseover="open"\n      class="popover"\n      @click.stop="toggle"\n    >\n      <div class="toggle">\n        <slot name="default"></slot>\n      </div>\n      <ul\n        v-if="show"\n        @mouseenter="open"\n        @mouseout="close"\n        @click.stop="toggle"\n      >\n        <slot name="popover"></slot>\n      </ul>\n    </ul>'}),Vue.component("popover-click",Vue.component("popover-hover").extend({name:"popover-click",methods:{setShow(e){this.show=e},open(){this.setShow(!0)},close(){this.setShow(!1)},toggle(){this.setShow(!this.show)}},mounted(){this.outsideClick=function(){this.setShow(!1)}.bind(this),document.documentElement.addEventListener("click",this.outsideClick)},beforeDestory(){document.documentElement.removeEventListener("click",this.outsideClick)},template:'\n    <button-link\n      @click.stop="toggle"\n      class="button-link"\n    >\n      <slot name="default" class="toggle"></slot>\n      <div v-if="show">\n        <slot name="popover"></slot>\n      </div>\n    </button-link>\n  '})),Vue.component("tab-bar",{props:["tabs","value"],name:"tab-bar",template:'<div class="ojoo-tabs md">\n      <div\n        v-for="([val, name], index) of Object.entries(tabs)"\n        @click="$emit(\'changed\', name)"\n        class="tab-item"\n        :class="{ active: value === name }"\n      >\n        {{ name }}\n      </div>\n      <slot name="side"></slot>\n    </div>'});const nameOfVar=e=>Object.keys(e)[0],withWarning=(e,{warning:t})=>(...a)=>(Ojoo.warn(t),e(...a));function deprecatedInFavorOf(e,t){const a=a=>(r,n,...o)=>(Ojoo.warn("You are using",n,`on '${e}' is deprecated - please use '${nameOfVar(t)}.${n}' instead`),a(r,n,...o));return new Proxy(t,{get:a((e,t)=>e[t]),set:a((e,t,a)=>e[t]=a),apply:a((e,t)=>e[t]())})}function withReturned(e){return function(t){const a=e["subCategory"===t?searchFieldLvl1Of("category"):searchFieldOf(t)]||{};return pairs(a)}}Vue.component("page-loader",{abstract:!0,mounted(){page_loader()},beforeDestroy(){remove_page_load()},render:()=>null}),Vue.component("spin-loader",{props:{secondary:{type:Boolean,default:!1},spinClass:String,default:""},template:"<div :class=\"['spin-loader', spinClass , { secondary }]\"></div>"}),Vue.component("ball-loader",{template:'<div class="ball-loader"></div>'});class UrlSessionStore extends Map{get(e){if(super.has(e))return super.get(e);try{return JSON.parse(sessionStorage.getItem(e))}catch(e){return JSON.parse(history.state)}}set(e,t){history.replaceState(JSON.stringify(t),"",location.pathname+location.search);try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){}return super.set(e,t)}}const init=new Vue({beforeCreate(){this.urlCache=new UrlSessionStore},methods:{location:(e="")=>e||location.pathname.includes("/search/audio")?location.pathname+location.search:location.pathname,set(e,t=this.location()){this.urlCache.set(this.location(t),e)},get(e=this.location()){return this.urlCache.get(this.location(e))}}}),all=new Vue({data(){return this.propFields=["url","uid"],{url:url,items:[]}},computed:{byAttr(){return itemsBy(this.items,...this.propFields)},activeItem(){return this.by(this.url.pathname)||{title:""}}},methods:{add(...e){return e.forEach(this.upsert),e},upsert(e){const t=this.itemBy(e);return t?Object.assign(t,items.missingInFrom(t,e)):(this.items.push(e),e)},itemBy(e){let t;return this.propFields.find(a=>{if(e[a])return t=this.byAttr[e[a]]}),t},by(e){return is.object(e)?this.itemBy(e):this.byAttr[e]}}});function itemFrom(e="",t=0,a={}){const r=a.name||trimAndLower(e),n={name:r,title:a.title||capitalize(r),tag:e,count:t,url:a.url||a.type?url.reWriteTermPath(a.type,e):void 0,key:urlize(e),...a};return all.upsert(n),n}const asItemWith=(e={})=>([t,a])=>itemFrom(t,a,"function"==typeof e?e():e);Vue.component("time-ago",{props:{at:{type:Number,default:0}},data:()=>({now:Date.now()}),computed:{timeAgo(){const e=Math.round((this.now-this.at)/1e3);if(!e)return"just now";const t={"just now":60,minute:3600,hour:86400,day:2592e3,month:31536e3,year:1/0};let a=1;const[r]=Object.entries(t).find(([,t])=>{const r=e<t;return r||(a=t),r}),n="just now"===r,o=Math.floor(e/a);return n?"just now":`${o} ${1===o||n?r:r+"s"} ago`}},mounted(){this.interval=setInterval(()=>this.now=Date.now(),6e4)},beforeDestroy(){clearInterval(this.interval)},template:"<span>{{timeAgo}}</span>"});const bodyOverlay=new Vue({data:()=>({isActive:!1,class:"overlay-active"}),watch:{isActive(e){body_overlay(e?"show":"hide",this.class)}}});class DefaultMap extends Map{get(e){return this.has(e)||this.set(e,this.defaultFn()),super.get(e)}constructor(e,t=[]){super(t);const a=typeof e;"object"===a&&console.warn("use a function to generate the default function"),"function"!==a&&(e=(()=>e)),this.defaultFn=e}}function combinations(...e){const t=[],a=(r,n)=>{for(let o=0;o<e[n].length;o++)n===e.length-1?t.push(r.concat(e[n][o])):a(r.concat(e[n][o]),n+1)};return a([],0),t}function initThreeDSecure(e){var t=$j(".api-three-d-auth-container"),a=recurly.Risk().ThreeDSecure({actionTokenId:e});a.on("error",handleThreeDSecureError),a.on("token",function(e){$j("#three-d-secure-token").val(e.id),t.hide(),$j(".api-three-d-submitting-msg").show(),$j("form").submit()}),a.attach(t[0]),t.show()}function handleThreeDSecureError(e){e.fields?($j("#errors").text("The following fields appear to be invalid: "+e.fields.join(", ")),$j.each(e.fields,function(e,t){$j("[data-recurly="+t+"]").addClass("error")})):e.message&&$j("#errors").text(e.message),$j("button").prop("disabled",!1)}Ojoo.recurly={url:"https://js.recurly.com/v4/recurly.js",placeholder:e=>({placeholder:e}),load:()=>load.js(Ojoo.recurly.url).then(Ojoo.recurly.setup),setup:()=>{recurly.configure({publicKey:fromDynamicData("financePublicKey"),style:{all:{fontFamily:"Helvetica",fontSize:"14px",fontColor:theme.recurlyFontColor},number:Ojoo.recurly.placeholder("Card number"),month:Ojoo.recurly.placeholder("Expiry MM"),year:Ojoo.recurly.placeholder("Expiry YYYY"),cvv:Ojoo.recurly.placeholder("Card Security Code")}})},handleError(e){$j("#errors").text("* Required fields"),$j("button").prop("disabled",!1),$j.each(e.fields,function(e,t){$j("[data-recurly="+t+"]").addClass("error"),$j(".recurly-hosted-field-card").addClass("recurly-hosted-field-invalid")})}};let _nodes=[...new Set(Object.values(dynamic_data.typesenseNodes||{}))];const typesenseHighAvailabilityNodes=[];let typeClient;function isPrintable(e){return is.nonEmptyArray(e)||is.number(e)||is.nonEmptyString(e)}function ifPrintable(e){return(t,a)=>q.isPrintable(a)?e(t,a):""}_nodes.forEach(e=>{typesenseHighAvailabilityNodes.push({host:e.replace("${SS_SEARCH_typesense_app_id}",dynamic_data.typesenseSearchHost),port:"443",protocol:"https"})}),typesenseHighAvailabilityNodes.length&&(typeClient=new Typesense.SearchClient({nearestNode:typesenseHighAvailabilityNodes[0],nodes:typesenseHighAvailabilityNodes.length>1?typesenseHighAvailabilityNodes.slice(1):typesenseHighAvailabilityNodes,apiKey:dynamic_data.typesenseSearchKey,connectionTimeoutSeconds:parseInt(dynamic_data.typesenseConnectionWaitTime)/1e3}));const joinWith=e=>(...t)=>t.filter(Boolean).join(e),q={isPrintable:isPrintable,ifPrintable:ifPrintable,joinWith:joinWith,and:joinWith(" && "),or:(...e)=>e,enum:joinWith(","),andIsEq:ifPrintable((e,t)=>(is.array(t)?t:[t]).map(t=>q.is(e,t))),is:ifPrintable((e,t)=>`${e}:${q.stringifyOneOrMany(t)}`),isEq:(e,t)=>{const a=is.array(t)?t.filter(Boolean):t;return isPrintable(a)?`${e}:=${q.stringifyOneOrMany(a)}`:""},isEqOrGreater:ifPrintable((e,t)=>`${e}:>=${q.stringifyOneOrMany(t)}`),isEqOrLess:ifPrintable((e,t)=>`${e}:<=${q.stringifyOneOrMany(t)}`),exactly:ifPrintable((e,t)=>`${e}:=\`${q.stringifyOneOrMany(t)}\``),isBetween:(e,[t,a])=>is.number(t)&&is.number(a)?`${e}:[${t}..${a}]`:"",range:(e,[t,a])=>is.number(t)&&is.number(a)?t===a?q.isEq(e,t):q.isBetween(e,[t,a]):is.number(t)&&!a?q.isEqOrGreater(e,t):!t&&is.number(a)?q.isEqOrLess(e,a):"",oneOrMany:(e="")=>is.array(e)&&1===e.length?e[0]:e,stringify:(e="")=>is.array(e)?`[${joinWith(",")(e.map(q.stringify))}]`:is.string(e)&&e.match(/\W/)?`\`${e}\``:e,stringifyOneOrMany:(e="")=>q.stringify(q.oneOrMany(e))},hasHighlights=fromDynamicData("hasHighlights"),queryParams=fromDynamicData("queryParams"),hasSearchMode=fromDynamicData("searchMode"),highlightsFrom=(e,t={})=>mapValues(itemsBy(e,"field"),e=>{if(e.snippet)return e.snippet;if(e.snippets){if(!t[e.field])return[];const a=[...t[e.field]];return e.snippets.forEach((t,r)=>a[e.indices[r]]=t),a}});function zipObjects(e={}){const t=Object.keys(e);return(e=>is.array(e)?e:e.values)(e[t[0]]).map((a,r)=>t.reduce((t,a)=>{const n=e[a];return is.object(n)||is.array(n)?(is.object(n)?t[a]=n.mapFn(n.values[r]):t[a]=n[r],t):(t[a]=n,t)},{}))}function zipItems(e,t){const a=zipObjects({tag:t[searchFieldOf(e)],key:t[siteUrlOf(e)],title:t[searchFieldOf(e)].map(capitalize),gurl:t[siteUrlOf(e)],url:{values:t[siteUrlOf(e)],mapFn:t=>url.reWriteTermPath(e,t)},highlighted:t.highlighted[searchFieldOf(e)],type:e});return all.add(...a),a}function quality(e,t){return`WAV, ${e/1e3}kHz, ${t}bit`}const convertHitsToNode=({document:e,highlights:t})=>{e.highlighted=highlightsFrom(hasHighlights?t:[],e),e.highlighted["vocab.category"]=(e.highlighted.hasOwnProperty("vocab.category.lvl.1")?e.highlighted["vocab.category.lvl.1"]:e.highlighted["vocab.category.lvl.0"]||e["vocab.category.lvl.1"]||e["vocab.category.lvl.0"]).replace(" > ","/ "),e.highlighted["vocab.genre"]=(e.highlighted.hasOwnProperty("vocab.genre.lvl.1")?e.highlighted["vocab.genre.lvl.1"]:e.highlighted["vocab.genre.lvl.0"]||e["vocab.genre.lvl.1"]||e["vocab.genre.lvl.0"]).replace(" > ","/ "),Object.setPrototypeOf(e.highlighted,e);var a=new Object;return a.bitrate=e["audio.bitrate"],a.bitrateMode=e["audio.bitrateMode"],a.bitsPerSample=e["audio.bitsPerSample"],a.bpm=convertBpmToClient(e["audio.bpm"]),a.channels=e["audio.channels"],a.downloadCount=e["audio.downloadCount"],a.fileMimetype=e["audio.fileMimetype"],a.fileSize=e["audio.fileSize"],a.filepath=e["audio.filepath"],a.format=e["audio.format"],a.playCount=e["audio.playCount"],a.playTime=e["audio.playTime"],a.sampleRate=e["audio.sampleRate"],a.storage=e["audio.storage"],e.audio=a,e.audio_playTime=e["audio.playTime"],e.playTime=toMinSeconds(e["audio.playTime"]),e.bpm=convertBpmToClient(e["audio.bpm"]),e.sharedUrl=prefixBasePath("/"+e.url),e.quality=quality(a.sampleRate,a.bitsPerSample),e.uid=String(e["user.uid"]),e.userName=e["user.name"],e.userUrl=e[siteUrlOf("artist")]?replaceToken(url.aliasPathFor("user-url"),e[siteUrlOf("artist")]):replaceToken(url.aliasPathFor("user-url","internal"),e[siteUrlOf("artist")]),e.artist=itemFrom(e["user.url"]||e["user.name"],0,{uid:String(e["user.uid"]),name:e["user.name"],type:"artist",picturePath:e[termConfigFor("artist").picturePath]}),e.categoryTag=e[searchFieldLvl1Of("category")],e.category=e[searchFieldLvl1Of("category")]?categories.by(e[searchFieldLvl1Of("category")]):e[searchFieldOf("category")]?categories.by(e[searchFieldOf("category")]):"",e.tags=zipItems("tag",e),e.similarTos=zipItems("similar_to",e),e.moods=zipItems("mood",e),e.instruments=zipItems("instrument",e),e.attributes=zipItems("attribute",e),e};let requestedSearch,collectedSeaches=[];const defaultSearchParams={facet_by:q.enum(...theme.facets),query_by:q.enum(Object.keys(theme.queryAndWeights)),query_by_weights:q.enum(Object.values(theme.queryAndWeights)),q:"*"},commonSearchParams={collection:typesenseCollection,per_page:dynamic_data.perPage||1,search_cutoff_ms:1e3,max_facet_values:234};function modeParams(e="fuzzy"){return queryParams[e].modeParameters}function search(e){return typeClient?new Promise((t,a)=>{collectedSeaches.push([{...defaultSearchParams,...commonSearchParams,...e},[t,a]]),requestedSearch||(requestedSearch=setTimeout(()=>{executeCollectedSeaches([...collectedSeaches]),collectedSeaches=[],requestedSearch=!1},25))}):Promise.resolve()}function executeCollectedSeaches(e){const t=e.map(([e])=>e),a=e.map(([,e])=>e);return typeClient.multiSearch.perform({searches:t}).then(({results:e})=>{Promise.all(e.map((e,t)=>{const[r]=a[t];r(prepareResult(e))}))})}function extractFacetsOf(e){return e.reduce((e,{field_name:t,counts:a,stats:r})=>(["audio.bpm","audio.playTime"].includes(t)?e[t]=r:e[t]=a.reduce((e,{value:t,count:a})=>(e[t]=a,e),{}),e),{})}function prepareResult(e){const{code:t,error:a,hits:r,found:n,facet_counts:o}=e;return!t&&o&&r&&is.number(n)?{facets:extractFacetsOf(o),hits:r.map(convertHitsToNode),found:n}:(console.error(`[Ojoo] search engine responded with error code: ${t} - ${a}`),{hits:[],found:0,facets:[]})}function byId(e){if(!typeClient)return Promise.resolve();e=[...new Set(e)];let t={query_by:"title",q:"*",per_page:dynamic_data.perPage||1,filter_by:["objectID:=["+e.map(e=>"`"+e+"`").join(",")+"]","published:= 1","type:[`"+dynamic_data.searchFilterType+"`]"].join(" && ")};return typeClient.collections(typesenseCollection).documents().search(t).then(t=>({hits:t.hits.map(convertHitsToNode),countNidsError:t.hits.length<e.length})).catch(err.handler())}search.mode="fuzzy";const searchUpdatedAt=getCookie("ojoo_search_updated")||"",taxonomyStoreKey=`ta_${fromDynamicData("currentThemeName")}_${typesenseCollection}_${searchUpdatedAt}`;function loadHierarchy(){if(!typeClient)return Promise.resolve({});const e=loadFromStore();return e?Promise.resolve(e):search({collection:typesenseCollection,q:"*",query_by:"objectID",query_by_weights:"1",per_page:0,facet_by:q.enum(searchFieldLvl1Of("category")),max_facet_values:555,filter_by:"type:[`"+dynamic_data.searchFilterType+"`]"}).then(({facets:e})=>({simpleHierarchy:withReturned(e)("subCategory").reduce((e,[t])=>{if(!t)return e;const[a,r]=t.split(" > ");return e[a]||(e[a]={name:a,url:url.reWriteTermPath("category",a),children:{}}),e[a].children[r]={name:r,url:url.reWriteTermPath("category",a,r)},e},{})})).then(putIntoStore).catch(err.handler())}function getCookie(e){let t=`; ${document.cookie}`.match(`;\\s*${e}=([^;]+)`);return t?t[1]:0}function loadFromStore(){try{return JSON.parse(localStorage.getItem(taxonomyStoreKey))}catch(e){}}function putIntoStore(e){try{localStorage.setItem(taxonomyStoreKey,JSON.stringify(e))}catch(e){}return e}Vue.component("theme-switcher",{mixins:[themesMixin],name:"theme-switcher",template:'<popover-hover class="theme-switcher" v-if="1 < themes.length">\n    <span class="desktop-only">{{selectedTheme.full_title}}</span>\n    <span class="mobile-only">{{selectedTheme.short_title}}</span>\n    <i class="icon-caret_down"></i>\n    <template #popover>\n      <popover-header>Search for</popover-header>\n      <li\n        v-for="theme of themes"\n        @click.prevent="$emit(\'theme-changed\', theme.theme_name)"\n      >\n        <a :href="theme.url">\n          <span class="desktop-only">{{theme.full_title}}</span>\n          <span class="mobile-only">{{theme.short_title}}</span>\n        </a>\n      </li>\n    </template>\n  </popover-hover>'}),Vue.component("theme-switcher-tabs",Vue.component("theme-switcher").extend({extend:"theme-switcher",name:"theme-switcher-tabs",template:'<div class="ojoo-tabs lg">\n    <div\n      v-for="theme of themes"\n      @click="$emit(\'theme-changed\', theme.theme_name)"\n      class="tab-item"\n      :class="{ active: currentTheme.theme_name === theme.theme_name }"\n    >\n      {{ theme.full_title }}\n    </div>\n  </div>'})),Vue.component("search-bar",{template:'<form\n    action="/search/audio"\n    method="get"\n    class="form-item search-bar"\n    @submit.prevent.stop=""\n    @click="$emit(\'click\')"\n  >\n    <slot></slot>\n  </form>'});const querySuggestApp=new Vue({mixins:[themesMixin],data(){return this.$_cachedResults=new DefaultMap(()=>new DefaultMap(()=>[])),{searchQuery:"dynamic_search"===fromDynamicData("pageType")?fromDynamicData("searchText"):"",searchPlaceholder:fromDynamicData("searchPlaceholder")||"",minAutoCompleteChars:dynamic_data.minAutoCompleteChars,hits:[],makingRequest:!1,hasFocus:!1,hasFocusTimer:null,selected:-1,allTermsOverride:{soundsnap5:{tag:"tag",category:"category",playlist:"collection"},music5:{tag:"attribute",category:"genre",playlist:"playlist"},beatopia5:{tag:"attribute",category:"genre",playlist:"playlist"}}}},computed:{cachedResults(){const e=this.selectedTheme&&this.selectedTheme.theme_name||dynamic_data.themeName;return this.$_cachedResults.get(e)}},watch:{cachedResults(){this.refineSearchSuggestions(this.searchQuery)},searchQuery(e){this.refineSearchSuggestions(e),this.selected=-1}},methods:{focusInput(){this.$refs.searchInput.focus()},blurInput(e){this.$refs.searchInput.blur(),this.setFocus(!1)},select(e){this.hits.length&&(this.selected=mod(e,this.hits.length))},clear(){this.searchQuery="",this.focusInput()},setFocus(e,t){clearTimeout(this.hasFocusTimer),e?this.hasFocus=e:this.hasFocusTimer=setTimeout(()=>this.hasFocus=e,35)},clearHasFocusTimeout(){this.hasFocus&&clearTimeout(this.$root.hasFocusTimer)},refineSearchSuggestions(e=""){if(e.length<this.minAutoCompleteChars)return this.hits=[];const t=this.selectedTheme?this.selectedTheme.typesense_search_filter_type:dynamic_data.searchFilterType;return this.cachedResults.has(e)&&(this.hits=[...this.cachedResults.get(e)]),this.makingRequest=!0,fetchSuggestionFor(e,t,this.allTermsOverride[this.selectedThemeName]||{}).then(t=>{this.hits=t,this.cachedResults.set(e,[...this.hits])}).catch(err.search).finally(()=>{this.makingRequest=!1})},executeSearch(e="",t){(e=e||this.hits[this.selected]||this.searchQuery).trim()&&(this.searchQuery=e,"undefined"!=typeof searchApp&&searchApp.mounted&&this.selectedTheme.name===this.currentTheme.name?url.singlePageLoad({searchTerm:e,pageType:"dynamic_search",pathname:this.selectedTheme.searchUrl}):url.load({searchParams:{query:e},pathname:this.selectedTheme.searchUrl}),this.blurInput())}},mounted(){this.cachedResults.set("",[]),this.refineSearchSuggestions(this.searchQuery),window.addEventListener("blur",this.clearHasFocusTimeout)}}),queryFacet=(e,t,a,r={})=>({q:e,query_by:t,query_by_weights:"1",facet_by:t,per_page:0,prefix:!0,rank_tokens_by:"FREQUENCY",facet_query:t+":"+e,max_facet_values:40,filter_by:"type:=[`"+a+"`]",search_cutoff_ms:1e3,...r});function fetchSuggestionFor(e,t,a){const r=[searchFieldOf(a.category),searchFieldOf("tag"),siteNameOf("artist"),searchFieldLvl1Of(a.category),searchFieldOf("instrument"),searchFieldOf("similar_to"),searchFieldOf("mood")].map(r=>search(queryFacet(e,r,t,a))),n=new RegExp(`^${e}`,"ig");return Promise.all(r).then(e=>uniq(e.map(({facets:e=[]})=>Object.values(e).map(pairs)).flat().flat().filter(([e])=>n.test(extractSubcategoryName(e))).sort(facetByCount).map(([e])=>trim(extractSubcategoryName(e).toLowerCase()," "))))}function extractSubcategoryName(e){return e.includes(" > ")?e.split(" > ")[1]:e}Ojoo.wrapperComponent("billing-details"),Ojoo.wrapperComponent("billing-card"),Ojoo.wrapperComponent("table-row"),Ojoo.wrapperComponent("empty-container",{class:"empty_container"}),Ojoo.wrapperComponent("billing-description",{class:"description"}),Ojoo.wrapperComponent("billing-name",{class:"billing-name"}),Vue.component("billing-card-img",{props:{paymentType:type.str},computed:{src:e=>asset(`svg/${e.paymentType}.svg`)},template:'<img :src="src" :alt="paymentType | capitalize">'});const payT={on:{recurly:"provider-recurly",crg:"provider-crgcard",none:"no-provider"},with:{card:"card",paypal:"paypal",crgCard:"crg_card",crgPaypal:"crg_paypal",none:"no-payments"}},typeCheckerFor=(e,t)=>a=>a[e]===t;Ojoo.billingDetailsComponent=((e,t={props:{}})=>{const a={props:{billing:{type:Object,required:!0},...t.props},inject:["threeDSecure"],methods:{asset:asset},template:`#template-${e}`};return delete t.props,Vue.component(e,{...a,...t})});const userId=fromDynamicData("billing","uid");function userPath(){return`/user/${this.uid}`}function userPathTo(...e){return[this.userPath,...e].filter(e=>e).join("/")}const isPaymentMethodOfType=e=>t=>t.billing.paymentType===e,paymentDetails={data:()=>({uid:userId}),props:{...type.each.asStr("buttonText","buttonId","buttonTarget","buttonTo"),showButtonFor:type.str},computed:{userPath:userPath,showButton:e=>(e.showButtonFor||"").split(",").includes(e.billing.paymentType),isCreditCard:isPaymentMethodOfType(payT.with.card),isPayPal:isPaymentMethodOfType(payT.with.paypal),isCrgCard:isPaymentMethodOfType(payT.with.crgCard),isCrgPaypal:isPaymentMethodOfType(payT.with.crgPaypal),isNoPayments:e=>!(e.isCreditCard||e.isPayPal||e.isCrgCard||e.isCrgPaypal)},methods:{userPathTo:userPathTo}};Ojoo.billingDetailsComponent("payment-details",paymentDetails),Ojoo.billingDetailsComponent("change-payment-details",paymentDetails),Ojoo.billingDetailsComponent("credit-card"),Ojoo.billingDetailsComponent("pay-pal"),Ojoo.billingDetailsComponent("crg-card"),Ojoo.billingDetailsComponent("crg-paypal"),Ojoo.billingDetailsComponent("no-payments",{props:{billing:{type:Object,default:()=>({})}}}),Vue.component("user-section",{props:type.each.asStr("fromDynamicData","title","description"),computed:{htmlContent(){return fromDynamicData(...this.fromDynamicData.split(","))}},template:'<div class="ojoo-section" v-once>\n    <h2 class="section-title" v-if="title">{{ title }}</h2>\n    <div class="description" v-if="description">{{ description }}</div>\n    <slot>\n      <div v-if="htmlContent" v-html="htmlContent"></div>\n    </slot>\n  </div>'}),Vue.component("collapse-container",{props:{title:{type:[String,Number],default:""},startOpen:{type:Boolean,default:!1}},template:'<div\n    class="js-collapse-container"\n    :class="startOpen ? \'js-collapse-active\' : \'\'"\n  >\n    <div class="js-collapse-trigger trigger-invoices">\n      <slot name="title">\n        {{ title }}\n      </slot>\n      <i class="icon-caret_top_big"></i>\n    </div>\n    <div\n      class="js-collapse-items"\n      :style="{ display: startOpen ? \'block\' : \'none\' }"\n    >\n      <slot></slot>\n    </div>\n  </div>'}),Vue.component("invoice-row",{props:{receipt:{type:Object,required:!0}},template:'<table-row>\n    <div>\n      {{ receipt.date }}\n    </div>\n\n    <div class="description">\n      {{ receipt.price }}\n    </div>\n\n    <div>\n      <modal-link\n        :href="receipt.url | ensureSlash"\n        class="primary-link"\n      >\n        View\n      </modal-link>\n    </div>\n\n    <div>\n      <a\n        :href="receipt.pdf_link | ensureSlash"\n        class="primary-link"\n      >\n        Download PDF\n      </a>\n    </div>\n  </table-row>'});let userApp=new Vue({data:()=>({uid:userId,paymentMethod:fromDynamicDataAsObject("billing","payment_info"),receipts:[...fromDynamicDataAsArray("billing","receipts","data"),...fromDynamicDataAsArray("receipts","data")],paymentInfoData:fromDynamicDataAsObject("paymentInfo"),paymentInfo:findFromDynamicData("no-payments",["billing","payment_info"],["paymentInfo","payment_info"]),threeDSecure:fromDynamicData("paymentInfo","3d_secure")}),provide(){return{threeDSecure:this.threeDSecure}},computed:{userPath:userPath,receiptsByYear(){const e=new Map;return this.receipts.forEach(t=>{const a=t.year;e.has(a)||e.set(a,[]),e.get(a).push(t)}),new Map([...e.entries()].sort().reverse())},isCrgCardPaymentInfo:typeCheckerFor("paymentInfoType",payT.with.crgCard),isCrgPaypalPaymentInfo:typeCheckerFor("paymentInfoType",payT.with.crgPaypal),isRecurlyPaypalPaymentInfo:typeCheckerFor("paymentInfoType",payT.with.paypal),isRecurlyCardPaymentInfo:typeCheckerFor("paymentInfoType",payT.with.card),hasNoPaymentInfo:typeCheckerFor("paymentInfoType",payT.with.none),isCrgPaymentPro:typeCheckerFor("paymentProType",payT.on.crg),isRecurlyPaymentPro:typeCheckerFor("paymentProType",payT.on.recurly),hasNoPaymentPro:typeCheckerFor("paymentProType",payT.on.none),paymentMethodType(){return this.paymentMethod.paymentType||payT.with.none},paymentInfoType(){return this.paymentInfo.paymentType||payT.with.none},paymentProType(){return this.isRecurlyCardPaymentInfo||this.isRecurlyPaypalPaymentInfo?payT.on.recurly:this.isCrgCardPaymentInfo||this.isCrgCardPaymentInfo?payT.on.crg:payT.on.none}},methods:{userPathTo:userPathTo,fromDynamicData:fromDynamicData},mounted(){this.isRecurlyPaymentPro&&Ojoo.recurly.load().then(()=>{if(this.threeDSecure)return initThreeDSecure(this.threeDSecure.action_token_id);$j("#for-section-page-edit").on("click",function(){$j("#section-page-view").hide(),$j("#section-page-edit").show()}),$j("form").on("submit",function(e){e.preventDefault(),$j("#errors").text(""),$j("input").removeClass("error"),$j("button").prop("disabled",!0);var t=this;recurly.token(t,(e,a)=>{e?Ojoo.recurly.handleError(e):t.submit()})})})}});Vue.component("checkout-form-component",{props:type.each.asStr("fromDynamicData"),computed:{htmlContent(){return fromDynamicData(...this.fromDynamicData.split(","))},transactionFailed(){return"object"==typeof this.htmlContent.form&&"success"!=this.htmlContent.form.transaction_status}},mounted(){this.transactionFailed||init_checkout_form()},template:'<div v-if="!transactionFailed" v-html="htmlContent.form"></div>\n    <checkout-failed :transaction="htmlContent.form.product_details" v-else></checkout-failed>'}),Vue.component("checkout-completed-component",{props:type.each.asStr("transaction"),computed:{transactionResponse(){return fromDynamicData(...this.transaction.split(","))},getTransaction(){return this.transactionResponse}},template:'<div>\n    <checkout-failed\n      v-if="transactionResponse.transaction_status === \'failed\'"\n      :transaction="transactionResponse"\n    ></checkout-failed>\n    <checkout-3d-secure\n      v-else-if="transactionResponse.transaction_status === \'3d_secure\'"\n      :transaction="transactionResponse"\n    ></checkout-3d-secure>\n    <checkout-success\n      v-else-if="transactionResponse.transaction_status === \'success\'"\n      :transaction="transactionResponse"\n    ></checkout-success>\n    <checkout-failed v-else :transaction="transactionResponse"></checkout-failed>\n  </div>'}),Vue.component("checkout-failed",{props:["transaction"],computed:{},mounted(){},computed:{getTransaction(){return this.transaction}},template:"#checkout-failed-template"}),Vue.component("checkout-success",{props:["transaction"],computed:{getTransaction(){return void 0!==this.transaction.transaction_status&&this.transaction},isTrial(){return this.getTransaction.product_details.trialLength>0}},template:"#checkout-success-template"}),Vue.component("checkout-3d-secure",{props:["transaction"],computed:{getTransaction(){return void 0!==this.transaction.transaction_status&&this.transaction}},mounted(){Ojoo.recurly.load().then(()=>initThreeDSecure(this.getTransaction.action_token_id))},template:"#checkout-3d-secure-template"}),Vue.component("redeem-coupon",{props:type.each.asStr("coupondata"),computed:{couponData(){return fromDynamicData(...this.coupondata.split(","))},getcouponData(){return this.couponData},userData:()=>fromDynamicData("userdata"),getSiteName:()=>fromDynamicData("sitename")},mounted(){initPromotionTabs()},template:'<div>\n    <div v-if="getcouponData.coupon_form" class="ojoo-section">\n      <h2>Enter your <br />promotional code</h2>\n      <div>\n        <div v-html="getcouponData.coupon_form"></div>\n        <div class="ojoo-footer-note">\n          <span v-if="userData.uid">\n            You are logged in as <b>{{ userData.mail }}</b>. Your promotional code\n            will be applied at the next step\n          </span>\n          <span v-else>\n            Your coupon will be automatically applied to your account as soon as\n            you create your account\n          </span>\n        </div>\n      </div>\n    </div>\n    <a\n      :href="getcouponData.reset_url"\n      class="api-checkout-back"\n      v-if="!getcouponData.coupon_form"\n    >&#8249; back</a>\n    <div v-if="!getcouponData.coupon_form" class="ojoo-section">\n      <h2>{{ getcouponData.coupon_description }}</h2>\n      <div class="ojoo-tabs">\n        <div class="tab-item active" id="checkout-login-tab">I have an account</div>\n        <div class="tab-item" id="checkout-register-tab">I\'m new to {{ getSiteName }}</div>\n      </div>\n      <div class="checkout-login-content" v-html="getcouponData.login_form"></div>\n      <div\n        id="user_register"\n        class="checkout-register-content"\n        v-html="getcouponData.register_form"\n      ></div>\n    </div>\n  </div>'}),Vue.component("promotion-success",{props:["transactionData"],computed:{getTransaction(){return this.transactionData},getBackUrl(){return this.getTransaction.back_url},isNewUserOnly(){return"new_user_only"==this.getTransaction.error_message},getcouponData(){return this.getTransaction.coupon_details||{}},getInvoiceDescription(){return this.getcouponData.invoiceDescription||this.getcouponData.hostedPageDescription},getAudioType:()=>fromDynamicData("audioType")},mounted(){console.log("promotion success")},template:"#promotion-success-template"}),Vue.component("promotion-failed",{props:["transactionData"],computed:{getTransaction(){return this.transactionData},getBackUrl(){return this.getTransaction.back_url},isNewUserOnly(){return"new_user_only"==this.getTransaction.error_message},getcouponData(){return this.getTransaction.coupon_details||{}},getInvoiceDescription(){return this.getcouponData.invoiceDescription||this.getcouponData.hostedPageDescription},getMessage(){switch(this.getTransaction.error_message){case"new_user_only":return{title:"Sorry, the code "+this.getcouponData.code+" couldn’t be activated",description:"This promotion is for new users only"};case"coupon_code_error":return{title:"Sorry, the code "+this.getcouponData.code+" couldn’t be activated",description:"You have already redeemed this code"};case"subscription_error":return{title:"Sorry, the code "+this.getcouponData.code+" couldn’t be activated",description:"You already have a subscription"};case"default_error":default:return{title:"Sorry, the code "+this.getcouponData.code+" couldn’t be activated",description:"We're sorry, something went wrong while activating your coupon. <br> Please use the button below to try again."}}}},mounted(){},template:"#promotion-failed-template"}),Vue.component("promotion-completed",{data:()=>({transactionData:fromDynamicData("transactionData")}),computed:{transactionSucceded(){return"success"===this.transactionData.transaction_status}},template:'<div>\n    <promotion-success\n      v-if="transactionSucceded"\n      :transaction-data="transactionData"\n    ></promotion-success>\n    <promotion-failed\n      v-else\n      :transaction-data="transactionData"\n    ></promotion-failed>\n  </div>'});let checkoutApp=new Vue({computed:{getTransaction:()=>fromDynamicData("transactiondata")},data:()=>({uid:uid})});function init_checkout_form(){var e=$j("form");if($j('label[for="edit-first_name"], label[for="edit-last_name"]').append('<span class="form-required">*</span>'),$j("#checkout-pp-tab").on("click",function(){$j(".checkout-cc-content").hide(),$j(".checkout-pp-content").show(),$j("#checkout-cc-tab").removeClass("active"),$j(this).addClass("active"),$j("#edit-recurly-checkout").val("paypal")}),$j("#checkout-cc-tab").on("click",function(){$j(".checkout-pp-content").hide(),$j(".checkout-cc-content").show(),$j("#checkout-pp-tab").removeClass("active"),$j("#subscribe-paypal").removeClass("active"),$j(this).addClass("active"),$j("#edit-recurly-checkout").val("cc")}),"undefined"!=typeof recurly){Ojoo.recurly.setup();var t=recurly.Pricing.Checkout();t.attach("#api-checkout"),t.attach(e),t.on("error",function(e){r(e)}),t.on("change",function(){t.price.next.taxes>0?$j(".js-has-vat").show():$j(".js-has-vat").hide()});var a=recurly.PayPal({display:{displayName:fromDynamicData("checkout_form").product_details.name}});function r(e){if("validation"==e.code||"invalid-parameter"==e.code){var t=e.fields.join(", ");~t.indexOf("_")&&(t=t.replace(/_/g," ")),$j("button").prop("disabled",!1),checkout_loader("stop"),$j.each(e.fields,function(e,t){$j("[data-recurly="+t+"]").addClass("error"),"number"!=t&&"month"!=t&&"year"!=t||$j(".recurly-hosted-field-card").addClass("recurly-hosted-field-invalid")}),"validation"==e.code&&$j("#errors").text("The following fields appear to be invalid: "+t),"invalid-parameter"==e.code&&$j("#param-errors").text(e.message)}else~e.message.toLowerCase().indexOf("coupon")&&$j("#coupon-errors").text("Invalid Coupon")}a.on("error",r),a.on("token",function(t){$j("#edit-recurly-token").val(t.id),e[0].submit()}),e.on("submit",function(e){if(e.preventDefault(),$j("#errors").text(""),$j("input").removeClass("error"),$j("#subscribe-paypal").hasClass("active"))$j(this).prop("disabled",!0),a.start(),checkout_loader("start","paypal");else{var t=this;recurly.token(this,function(e,a){e?r(e):(checkout_loader("start","cc"),t.submit(),$j("#subscribe-cc").prop("disabled",!0))})}})}else $j("button").prop("disabled",!0),$j("body").append('<div class="blocker"></div>'),message="There was a problem loading payment process.",message+="<br>If you are using a browser plugin (DuckDuckGo, Privacy Badger, etc), ",message+='try <a href="https://support.box.com/hc/en-us/articles/360044196613-How-To-Disable-Plugins-Add-Ons-Extensions-In-Multiple-Browsers">disabling it</a>, ',message+="or use Private Browsing/ Incognito Mode before reloading the page.",message+="<br>If the problem persist, please contact support.",message+='<br><br><a href="products">Back to products</a>',$j(".blocker").html('<div class="page-overlay-msg"> '+message+"</div>"),$j.ajax({url:"/api/recurly/log/404-js"});var n=$j("#edit-profile_country"),o=$j(".js-vat-container"),s=Object.values(fromDynamicData("eu_countries"));n.on("change init",function(e){~s.indexOf(this.value)?o.show():o.hide()}).triggerHandler("init")}function activate(e){$j("#"+e).addClass("active")}function checkout_loader(e,t=!1){var a;"paypal"===t?(a='<img src="'+fromDynamicData("asset_icon_paypal_white_path")+'" width="116" alt="Paypal White Icon"><br><br><br>If a Paypal window hasn\'t launched, you may need to <a href="https://itsupport.smu.edu.sg/hc/en-us/articles/208234278-How-to-configure-your-web-browser-to-allow-pop-up-windows-" target="_blank">allow pop ups</a> to proceed.',a+="<br>Please don't close or refresh this page while your Paypal transaction is processing. This may take up to 90 seconds. ",a+="<br>If you want to cancel, please hit refresh."):a="Please don't close or refresh this page while your transaction is processing.<br>This may take up to 90 seconds.","start"===e?(page_loader(!0),setTimeout(function(){remove_page_load(),$j(".blocker").html('<div class="page-overlay-msg">'+a+"</div>")},2e3)):"stop"===e&&remove_page_load()}function initPromotionTabs(){$j("#checkout-login-tab").on("click",function(){$j(".checkout-register-content").hide(),$j(".checkout-login-content").show(),$j("#checkout-register-tab").removeClass("active"),$j(this).addClass("active")}),$j("#checkout-register-tab").on("click",function(){$j(".checkout-login-content").hide(),$j(".checkout-register-content").show(),$j("#checkout-login-tab").removeClass("active"),$j(this).addClass("active")})}let productApp=new Vue({data:()=>({productGroups:fromDynamicData("productGroups"),isLoggedIn:isLoggedIn}),computed:{packsHeader(){return this.productGroups.is_single?"Great Value":"Pay as you go"},packs(){return Object.values(this.productGroups.packs)},subscriptionHeader(){return this.productGroups.is_single?"Great Value":"Sound Effects & Music Plans"},subscriptions(){return Object.values(this.productGroups.subscriptions)},subShown(){return this.subscriptions[0]},subHidden(){return this.subscriptions[1]}}});var checkCoupon=function(){"use strict";return{initCheckCoupon:function(){var e=jQuery("form#api_coupons_code .form-submit");jQuery("form#api_coupons_code");e.on("click",function(e){e.preventDefault();var t=jQuery("#edit-coupon_code");if(!$j.trim(t.val()).length)return!1;page_loader(!0),jQuery.ojooAjax({type:"POST",data:{value:t.val()},url:"/api/coupon",success:function(e){var a=jQuery.parseJSON(e);jQuery(".form-item-msg").remove(),0==a.success?(t.addClass("error"),t.next("label").after('<div class="form-item-msg error">'+a.msg+"</div>")):(t.removeClass("error"),jQuery(".form-item-msg").remove(),window.location=window.location.href),remove_page_load()},error:function(e){t.addClass("error"),t.next("label").after('<div class="form-item-msg error">This code seems to be invalid</div>'),remove_page_load()}})})}}}();if(jQuery(function(){checkCoupon.initCheckCoupon()}),void 0===search)throw Ojoo.error("no search engine found");const makeCategoriesArray=(e={})=>{const t=[];for(let[a,r]of Object.entries(e)){if(!a)continue;const e={key:urlize(a.toLowerCase()),name:a.toLowerCase(),title:a,url:prefixBasePath(r.url),tag:a,subcategories:[],count:0,type:"main",categoryText:a,active:[a]};for(let[t,n]of Object.entries(r.children))e.subcategories.push({key:urlize(`${e.tag} > ${t}`.toLowerCase()),name:t.toLowerCase(),title:t,url:prefixBasePath(n.url),tag:`${e.tag} > ${t}`,parentTag:e.tag,parentUrl:e.url,count:0,type:"sub",categoryText:[a,t].join("/ "),active:[t,a]});e.subcategories.sort((e,t)=>e.name.localeCompare(t.name)),t.push(e)}return t.sort((e,t)=>e.name.localeCompare(t.name)),t};function titleized(e){return capitalizeEachWord(e.replaceAll("_"," "))}const categories=new Vue({data(){return this.emptyCategory={title:"",url:"",key:"empty",name:"",tag:"",count:0,type:"empty",categoryText:"",subcategories:[],active:[""]},{simpleHierarchy:{}}},beforeCreate(){loadHierarchy().then(({simpleHierarchy:e}={})=>this.simpleHierarchy=e)},computed:{all(){return makeCategoriesArray(this.simpleHierarchy)},each(){return this.all.reduce((e,t)=>(e.push(t),t.subcategories.forEach(t=>e.push(t)),e),[])},isMain(){return"main"===this.current.type},isSub(){return!this.isMain},attrToCategory(){return itemsBy(this.each,"url","name","tag","categoryName","title")},current(){return url.pathname,this.attrToCategory[this.$apps.url.pathname]||this.attrToCategory[location.pathname]||this.emptyCategory},parent(){return this.isMain?this.current:this.attrToCategory[this.current.parentUrl]||this.emptyCategory},active(){return this.isMain?[this.current]:[this.parent,this.current]}},methods:{byEmpty(e){return this.by(e)||this.emptyCategory},by(e){return this.attrToCategory[e]}}});Vue.component("browse-categories",{props:{showMax:{type:Number,default:3},preLinkText:{type:String,default:"Browse"},postLinkText:{type:String,default:"Sounds"},viewLessText:{type:String,default:"View Less"},viewAllText:{type:String,default:"View All"}},computed:{categories:()=>categories.all},methods:{spaced:(...e)=>e.filter(e=>e).join(" ")},template:'<div class="container ojoo-browse-categories">\n    <div\n      v-for="(category, index) in categories"\n      :key="category.tag"\n      v-if="category.subcategories.length"\n      class="js-collapse-container"\n    >\n      <h2 class="column-header">\n        <a\n          :href="category.url"\n          :title="spaced(preLinkText, category.title, postLinkText)"\n        >{{ category.title }}</a>\n      </h2>\n\n      <h3\n        v-for="(sub, index) in category.subcategories"\n        :class="{\'js-collapse-items\': showMax <= index  }"\n      >\n        <a\n          :href="sub.url"\n          :title="spaced(preLinkText, sub.title, postLinkText)"\n        >{{ sub.title }}</a>\n      </h3>\n\n      <a\n        v-if="showMax < category.subcategories.length"\n        href=""\n        class="js-collapse-trigger"\n        :data-js-text="viewLessText"\n      >{{ viewAllText }}</a>\n    </div>\n  </div>'});
